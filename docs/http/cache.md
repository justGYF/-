# http缓存

## 强缓存

### 字段：
    
Expires: 时间戳，用于指定缓存的过期时间，由于本地时间和服务器时间可能存在巨大差异，所以以此作为过期时间并不准确

Cache-Control: 通过设置max-age= 设置过期时间，单位为秒。

Cache-Control可选值（可多选）

#### 可缓存性
| 字段 | 含义 |
| --- | --- |
| public | 表明响应可以被任何对象，例：发送请求的客户端，代理服务器 |
| private | 只可被单个用户缓存，本地浏览器 |
| no-cache | 强制访问服务器，验证缓存，即使强缓存已命中 |
| no-store | 不可使用任何缓存，直接从服务器返回资源 |

#### 到期
| 字段 | 含义 |
| --- | --- |
| max-age | 缓存的最大时间，单位S |


在命中强缓存的情况下，会直接读取缓存，没有命中后，会看是否命中协商缓存，命中，读取缓存，反之读取服务器资源

## 协商缓存

### 字段

响应头 / 请求头 （请求头取得是上一次响应头的值）
Last-Modified / If-modified-since
Etag / if-None-Match

Last-Modified 资源最后一次的更新时间
Etag  资源的唯一标识，资源内容更新后Etag会改变

If-modified-since / if-None-Match 用于与对应的字段做对比

Etag的优先级高于Last-Modified

Last-Modified缺点：
    
    只能精确到秒级，1秒内的更新无法感知
    对于某些定期生成的文件，内容没变，Last-Modified却变了，导致无法使用缓存
    存在服务器未准确获取文件修改时间或与代理服务器时间不一致等